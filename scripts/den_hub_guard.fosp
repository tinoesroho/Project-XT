                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             

import bool AddAttackPlane(Critter&npc,uint priority,Critter&target)from"npc_planes";
import bool AddAttackPlane(Critter&npc,uint priority,uint critId)from"npc_planes";  

void _GuardInit(Critter&guard,bool firstTime)
{
	guard.SetEvent((16),"_GuardAttacked");
	guard.SetEvent((18),"_GuardMessage");
	guard.SetEvent((17),"_GuardStealing");
	guard.StatBase[(95)]=13;
}

bool _GuardAttacked(Critter&npc,Critter&attacker)
{
	if(attacker.StatBase[(95)]!=13)
	{
		npc.SendMessage(124,attacker.Id,(2));
		npc.ErasePlane((1),true);
		AddAttackPlane(npc,0,attacker);
		return true;
	}
	return false;
}

void _GuardMessage(Critter&npc,Critter&cr,int num,int val)
{
	if(npc.Cond!=(1))
	return;
	if(num==124)
	{
		npc.ErasePlane((1),true);
		AddAttackPlane(npc,0,uint(val));
	}
}

void _GuardStealing(Critter&npc,Critter&thief,bool success,Item&item,uint count)
{
	if(success==false)
	{
		npc.SendMessage(124,thief.Id,(2));
		npc.SayMsg((4),(0),(1300));
		npc.ErasePlane((1),true);
		AddAttackPlane(npc,0,thief);
	}
}
